import { Tutorial } from '../types';

export const linkPredictionTutorial: Tutorial = {
  id: 'link-prediction',
  title: 'リンク予測',
  description: 'グラフ上の未知のリンクを予測する手法を学びます。',
  category: 'graph-theory',
  steps: [
    {
      id: 'hook',
      title: '未来のつながりを予測',
      content: '来月、あなたは誰と友達になるでしょうか？\n\n既存のネットワーク構造から、将来生まれる辺を予測するのがリンク予測です。\n\n予測されたリンクが現れるアニメーションを見てみましょう。',
      sceneConfig: { showGrid: true, showAxes: true, cameraPosition: [0, 0, 5] },
      interactive: false,
      nextCondition: 'click',
      stepType: 'animation',
    },
    {
      id: 'touch',
      title: 'リンク予測を試そう',
      content: 'ネットワーク内で、まだ辺がないが将来つながりそうな頂点ペアを予測しましょう。\n\n共通の友人が多いペアほどつながりやすいでしょうか？\n\n予測スコアを確認してください。',
      sceneConfig: { showGrid: true, showAxes: true, cameraPosition: [0, 0, 5] },
      interactive: true,
      nextCondition: 'interaction',
      stepType: 'interactive',
    },
    {
      id: 'example-1',
      title: 'ヒューリスティクスによる予測',
      content: 'シンプルなリンク予測指標：\n\n- 共通隣接数：|N(u) ∩ N(v)|\n- ジャカード係数：|N(u) ∩ N(v)| / |N(u) ∪ N(v)|\n- Adamic-Adar：Σ 1/log|N(w)| (w ∈ N(u) ∩ N(v))\n- 優先的選択：|N(u)| × |N(v)|\n\nこれらは局所的な構造情報を使います。',
      sceneConfig: { showGrid: true, showAxes: true, cameraPosition: [0, 0, 5] },
      interactive: false,
      nextCondition: 'click',
      stepType: 'explanation',
    },
    {
      id: 'example-2',
      title: '学習ベースの予測',
      content: '機械学習によるリンク予測：\n\n- グラフ埋め込み：頂点ベクトルの内積やMLPでスコア計算\n- GNN：サブグラフの構造パターンを学習\n- SEAL：局所サブグラフをGNNで分類\n\n学習ベースの方法は、ヒューリスティクスでは捉えきれないパターンを学習できます。',
      sceneConfig: { showGrid: true, showAxes: true, cameraPosition: [0, 0, 5] },
      interactive: false,
      nextCondition: 'click',
      stepType: 'explanation',
    },
    {
      id: 'predict',
      title: '確認クイズ',
      content: 'クイズに答えましょう。',
      sceneConfig: { showGrid: true, showAxes: true, cameraPosition: [0, 0, 5] },
      interactive: false,
      nextCondition: 'click',
      stepType: 'quiz',
      quiz: {
        question: 'リンク予測で「共通の友人が多いペアはつながりやすい」を表す指標は？',
        options: [
          { id: 'a', label: '次数中心性', correct: false },
          { id: 'b', label: '共通隣接数', correct: true },
          { id: 'c', label: '最短距離', correct: false },
          { id: 'd', label: 'クラスタリング係数', correct: false },
        ],
        explanation: '共通隣接数は2頂点の共通の隣接頂点の数であり、この値が大きいほどリンクが生まれやすいと予測します。',
      },
    },
    {
      id: 'alternate',
      title: '知識グラフ補完',
      content: 'リンク予測は知識グラフの欠損補完にも使われます。\n\n例：（アインシュタイン, 出身地, ?）の?を予測\n\n- TransE、RotatE：埋め込みベースの手法\n- GNN：グラフ構造を直接利用\n\n推薦システムやドラッグリポジショニングにも応用されています。',
      sceneConfig: { showGrid: true, showAxes: true, cameraPosition: [0, 0, 5] },
      interactive: false,
      nextCondition: 'click',
      stepType: 'explanation',
    },
    {
      id: 'summary',
      title: 'まとめ',
      content: '今回学んだポイント：\n\n1. リンク予測は未知のつながりを予測する\n2. ヒューリスティクスと学習ベースの方法がある\n3. SNS、知識グラフ、薬物設計に応用\n\nリンク予測を操作して確認しましょう！',
      sceneConfig: { showGrid: true, showAxes: true, cameraPosition: [0, 0, 5] },
      interactive: true,
      nextCondition: 'click',
      stepType: 'interactive',
    },
  ],
};
